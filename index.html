<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Goosebox</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="assets/logo_beta.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/logo_beta.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/logo_beta.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/logo_beta.png">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 国旗图标库 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.3.2/css/flag-icons.min.css" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            wood:  { 50:'#f6efe9',100:'#eadfd3',200:'#d8c1a8',300:'#c8a37e',400:'#b8875a',500:'#9b6f48',600:'#7c583a',700:'#654830',800:'#523a26',900:'#3e2c1d'},
            hay:   { 50:'#fff8e6',100:'#ffefc2',200:'#ffe38f',300:'#ffd24d',400:'#fbbf24',500:'#f59e0b'},
            field: { 50:'#f4fde8',100:'#e3fac5',200:'#c6f18c',300:'#a2e251',400:'#7ace24',500:'#5cab17'},
            stone: { 300:'#d1d5db',400:'#9ca3af',700:'#374151'}
          },
          boxShadow: { ui:'0 8px 20px rgba(0,0,0,.12)' },
          borderRadius: { ui:'18px' }
        }
      }
    }
  </script>
  <style>
    .grain {
      background:
        radial-gradient(1000px 400px at 80% -20%, rgba(255,255,255,.25), rgba(255,255,255,0)),
        linear-gradient(180deg, #f7e7d5 0%, #fff6e8 40%, #f9efe3 100%);
    }
    .float { animation: float 4s ease-in-out infinite; }
    @keyframes float { 0%{transform:translateY(0)}50%{transform:translateY(-8px)}100%{transform:translateY(0)} }
    .logo { height: 50px; width: auto; }
    .flogo { height: 80px; width: auto; }
  </style>
</head>
<body class="bg-wood-50 text-stone-700">

  <!-- 顶部：木板导航 -->
  <header class="sticky top-0 z-50">
    <div class="bg-wood-400 shadow-ui text-white">
      <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <!-- 鹅头像 -->
          <img alt="Goosebox Logo" class="logo" loading="lazy" src="assets/logo_beta.png"/>
          <div class="leading-tight">
            <div class="font-extrabold text-lg">Goosebox</div>
            <div class="text-white/80 text-xs" id="subtitle"></div>
          </div>
        </div>

        <!-- 桌面端导航 -->
        <nav class="hidden md:flex items-center gap-6 text-white/90">
          <a href="#home" class="hover:text-white" data-lang="nav.home"></a>
          <a href="#mechanics" class="hover:text-white" data-lang="nav.highlights"></a>
          <a href="#lucky-draw" class="hover:text-white font-semibold px-3 py-1 rounded-md bg-white/10 hover:bg-white/20 transition" aria-label="Lucky Draw Event">Lucky Draw</a>
          <a href="#play" class="hover:text-white" data-lang="nav.play"></a>
          <a href="#faq" class="hover:text-white" data-lang="nav.faq"></a>
          
          <!-- 语言选择器 -->
          <div class="relative group">
            <button class="flex items-center gap-2 hover:text-white transition-colors duration-200" id="currentLang">
              <span id="currentLangFlag" class="fi fi-cn text-lg"></span>
              <span id="currentLangName">中文</span>
            </button>
            <div class="absolute left-1/2 -translate-x-1/2 top-full mt-2 bg-white rounded-ui shadow-ui border border-wood-200 py-2 min-w-[180px] opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top scale-95 group-hover:scale-100">
              <div id="languageOptions"></div>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </header>

  <!-- Lucky Draw Promo -->
  <section id="lucky-draw" class="bg-gradient-to-r from-hay-300 via-hay-400 to-wood-400 text-wood-900">
    <div class="max-w-6xl mx-auto px-4 py-6">
      <div class="grid md:grid-cols-3 gap-6 items-center">
        <div class="md:col-span-2">
          <div class="flex items-center gap-3 flex-wrap">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/80 text-wood-800 shadow-ui">
              <span class="text-xs font-bold tracking-wide">EVENT</span>
              <span class="text-xs">Lucky Draw</span>
            </div>
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/80 text-wood-800 shadow-ui" aria-live="polite">
              <span class="text-xs font-bold tracking-wide" id="luckyTimerLabel">Ends in</span>
              <span class="text-xs tabular-nums" id="luckyTimer">--</span>
            </div>
          </div>
          <h2 class="mt-3 text-2xl md:text-3xl font-extrabold drop-shadow-[0_1px_0_rgba(255,255,255,.6)]" data-lang="lucky.title">Spin & Win Big Prizes</h2>
          <p class="mt-2 text-stone-800/90" data-lang="lucky.subtitle">Join the Goosebox Lucky Draw. Spin daily for PHRS, boosts, and surprises!</p>
          <div class="mt-4 flex flex-wrap gap-3">
            <a href="https://spin.gbox.game/" target="_blank" rel="noopener noreferrer"
               class="inline-flex items-center gap-2 px-6 py-3 rounded-ui bg-white text-wood-900 font-bold shadow-ui hover:bg-wood-50 focus:outline-none focus:ring-2 focus:ring-white/60">
              <span data-lang="lucky.button">Spin Now</span>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor" aria-hidden="true"><path d="M13 5l7 7-7 7v-4H4v-6h9V5z"/></svg>
            </a>
            <a href="#faq" class="inline-flex items-center px-4 py-3 rounded-ui bg-white/30 text-wood-900 font-semibold hover:bg-white/40">FAQ</a>
          </div>
        </div>
        <div class="rounded-[18px] overflow-hidden shadow-ui bg-white/70">
          <img src="assets/goosebox-spin.jpg" alt="Goosebox Lucky Draw" class="w-full h-auto object-cover">
        </div>
      </div>
    </div>
  </section>

  <!-- Hero -->
  <section id="home" class="grain">
    <div class="max-w-6xl mx-auto px-4 py-12 md:py-16">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div>
          <h1 class="text-3xl md:text-4xl font-extrabold text-wood-900 leading-tight" id="heroTitle"></h1>
          <p class="mt-4 text-stone-700" id="heroDescription"></p>
          <div class="mt-8 flex flex-col sm:flex-row gap-3">
            <a href="https://dapp.gbox.game" class="px-6 py-3 rounded-ui bg-hay-400 text-wood-900 font-bold shadow-ui hover:bg-hay-300" id="playNowBtn"></a>
            <a href="faucet.html" class="px-6 py-3 rounded-ui bg-wood-300 text-wood-900 font-bold shadow-ui hover:bg-wood-200" data-lang="nav.faucet">
              Get PHRS
            </a>
          </div>
        </div>

        <!-- 鹅+农场插画 -->
        <div class="float">
          <img src="assets/goosebox_ranch.png" alt="Goosebox Ranch" class="w-full" loading="lazy">
        </div>
      </div>
    </div>
  </section>

  <!-- 四大亮点 -->
  <section id="mechanics" class="py-12 bg-wood-50">
    <div class="max-w-6xl mx-auto px-4">
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-5">
        <!-- A 挂机养鹅 -->
        <article class="rounded-[18px] bg-white border border-wood-200 p-6 shadow-ui">
          <div class="flex items-center gap-2">
            <span class="w-8 h-8 rounded-full bg-wood-100 text-wood-700 font-extrabold flex items-center justify-center">A</span>
            <h3 class="font-extrabold text-lg text-wood-900" data-lang="highlights.idle.title"></h3>
          </div>
          <p class="mt-3 text-stone-700" data-lang="highlights.idle.description"></p>
        </article>

        <!-- B 升级鹅舍 -->
        <article class="rounded-[18px] bg-white border border-wood-200 p-6 shadow-ui">
          <div class="flex items-center gap-2">
            <span class="w-8 h-8 rounded-full bg-wood-100 text-wood-700 font-extrabold flex items-center justify-center">B</span>
            <h3 class="font-extrabold text-lg text-wood-900" data-lang="highlights.upgrade.title"></h3>
          </div>
          <p class="mt-3 text-stone-700" data-lang="highlights.upgrade.description"></p>
        </article>

        <!-- C 任务 & 社区 -->
        <article class="rounded-[18px] bg-white border border-wood-200 p-6 shadow-ui">
          <div class="flex items-center gap-2">
            <span class="w-8 h-8 rounded-full bg-wood-100 text-wood-700 font-extrabold flex items-center justify-center">C</span>
            <h3 class="font-extrabold text-lg text-wood-900" data-lang="highlights.community.title"></h3>
          </div>
          <p class="mt-3 text-stone-700" data-lang="highlights.community.description"></p>
        </article>

        <!-- D 早期加成 -->
        <article class="rounded-[18px] bg-white border border-wood-200 p-6 shadow-ui">
          <div class="flex items-center gap-2">
            <span class="w-8 h-8 rounded-full bg-wood-100 text-wood-700 font-extrabold flex items-center justify-center">D</span>
            <h3 class="font-extrabold text-lg text-wood-900" data-lang="highlights.early.title"></h3>
          </div>
          <p class="mt-3 text-stone-700" data-lang="highlights.early.description"></p>
        </article>
      </div>
    </div>
  </section>

  <!-- 开始游戏 -->
  <section id="play" class="py-12">
    <div class="max-w-6xl mx-auto px-4 grid md:grid-cols-2 gap-6 items-center">
      <div>
        <h2 class="text-2xl font-extrabold text-wood-900" id="playTitle"></h2>
        <p class="text-stone-600 mt-2" id="playSubtitle"></p>
        <ol class="mt-3 list-decimal ml-5 text-stone-700 space-y-1" id="playSteps"></ol>
        <div class="mt-5">
          <a href="https://dapp.gbox.game"
             class="inline-flex items-center px-6 py-3 rounded-[18px] bg-hay-400 text-wood-900 font-bold shadow-ui hover:bg-hay-300" id="playBtn"></a>
        </div>
      </div>

      <div class="rounded-[18px] bg-white border border-wood-200 p-6 shadow-ui">
        <div class="text-sm text-stone-500" id="tipsTitle"></div>
        <p class="mt-1 text-stone-700" id="tipsContent"></p>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="py-12 bg-wood-50">
    <div class="max-w-4xl mx-auto px-4 space-y-4" id="faqContainer"></div>
  </section>

  <footer class="bg-white border-t border-wood-200">
    <div class="max-w-6xl mx-auto px-4 py-8 flex flex-col items-center gap-4">
      <!-- 社交按钮 -->
      <div class="flex items-center gap-4">
        <!-- X -->
        <a href="https://x.com/GooseBoxGame" target="_blank" rel="noopener noreferrer"
           aria-label="Goosebox on X"
           class="inline-flex items-center gap-2 px-4 py-2 rounded-[14px] bg-wood-100 border border-wood-200 text-wood-900 shadow-ui hover:bg-wood-200">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1227" class="w-5 h-5" fill="currentColor">
            <path d="M714 519l452-519H1002L652 408 357 0H0l469 638L0 1227h198l375-431 311 431h357L714 519zM593 742l-86-118-308 353h180l214-235zm263 170L742 694l-84 92 220 305h170L856 912zM326 142l610 910h-171L261 142h65z"/>
          </svg>
          <span>X</span>
        </a>
        <!-- Telegram -->
        <a href="https://t.me/GooseBoxTG" target="_blank" rel="noopener noreferrer"
           aria-label="Goosebox on Telegram"
           class="inline-flex items-center gap-2 px-4 py-2 rounded-[14px] bg-wood-100 border border-wood-200 text-wood-900 shadow-ui hover:bg-wood-200">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" class="w-5 h-5" fill="currentColor">
            <path d="M120 0a120 120 0 10120 120A120 120 0 00120 0zm58.1 75.5L147 179.8c-2 9.2-7.5 11.4-15.2 7.1l-42-31  -20.2 19.4c-2.2 2.2-4 4-8.2 4l2.9-41.2 74.9-67.5c3.3-2.9-.7-4.6-5.1-1.7l-92.5 58.2-39.8-12.4c-8.6-2.7-8.8-8.6 1.8-12.7l155.8-60.1c7.2-2.6 13.5 1.7 11.1 12.1z"/>
          </svg>
          <span>Telegram</span>
        </a>
      </div>

      <p class="text-stone-400">© 2025 Goosebox</p>
    </div>
  </footer>

  <script src="./js/languages.js"></script>
  <!-- <script type="module" src="/src/main.js"></script> -->

  <script>
    (function checkTwitterCallback() {
      const urlParams = new URLSearchParams(window.location.search);
      const state = urlParams.get('state');
      const code = urlParams.get('code');
      
      if (state && code) {
        console.log('🔄 检测到 Twitter 回调参数，重定向到 faucet.html...');
        const newUrl = `./faucet.html${window.location.search}`;
        window.location.href = newUrl;
        return;
      }
    })();
  </script>
  
  <script>
    let currentLang = defaultLanguage;

    function initLanguage() {
      const savedLang = localStorage.getItem('goosebox_lang');
      if (savedLang && languageConfig[savedLang]) {
        currentLang = savedLang;
      }
      updateLanguage(currentLang);
      renderLanguageSelector();
      initLuckyTimer();
    }

    function updateLanguage(lang) {
      const langData = getLanguageData(lang);
      
      document.title = langData.title;
      
      document.querySelectorAll('[data-lang]').forEach(el => {
        const key = el.getAttribute('data-lang');
        const value = getNestedValue(langData, key);
        if (value) {
          if (el.tagName === 'INPUT' && el.type === 'placeholder') {
            el.placeholder = value;
          } else {
            el.textContent = value;
          }
        }
      });

      document.getElementById('subtitle').textContent = langData.subtitle;
      document.getElementById('heroTitle').textContent = langData.hero.title;
      document.getElementById('heroDescription').innerHTML = langData.hero.description;
      document.getElementById('playNowBtn').textContent = langData.hero.playNow;
      document.getElementById('playTitle').textContent = langData.play.title;
      document.getElementById('playSubtitle').textContent = langData.play.subtitle;
      document.getElementById('playBtn').textContent = langData.play.button;
      document.getElementById('tipsTitle').textContent = langData.play.tips.title;
      document.getElementById('tipsContent').textContent = langData.play.tips.content;

      const stepsContainer = document.getElementById('playSteps');
      stepsContainer.innerHTML = langData.play.steps.map(step => `<li>${step}</li>`).join('');

      const faqContainer = document.getElementById('faqContainer');
      faqContainer.innerHTML = `
        <details class="rounded-ui bg-white border border-wood-200 p-4 shadow-ui group">
          <summary class="cursor-pointer font-semibold flex items-center justify-between">
            <span>${langData.faq.lucky?.question || 'Lucky Draw — Rules'}</span>
            <span class="text-stone-400 group-open:rotate-180 transition">⌄</span>
          </summary>
          <ul class="mt-3 text-stone-700 list-disc pl-5 space-y-1">
            ${(() => {
              const a = langData.faq.lucky?.answer;
              if (!a) return '';
              const parts = [a.rule1, a.rule3, a.rule4].filter(Boolean);
              return parts.map(t => `<li>${t}</li>`).join('');
            })()}
          </ul>
        </details>
        <details class="rounded-ui bg-white border border-wood-200 p-4 shadow-ui group">
          <summary class="cursor-pointer font-semibold flex items-center justify-between">
            <span>${langData.faq.offline.question}</span>
            <span class="text-stone-400 group-open:rotate-180 transition">⌄</span>
          </summary>
          <div class="mt-3 text-stone-700">${langData.faq.offline.answer}</div>
        </details>
        <details class="rounded-ui bg-white border border-wood-200 p-4 shadow-ui group">
          <summary class="cursor-pointer font-semibold flex items-center justify-between">
            <span>${langData.faq.tokens.question}</span>
            <span class="text-stone-400 group-open:rotate-180 transition">⌄</span>
          </summary>
          <div class="mt-3 text-stone-700">${langData.faq.tokens.answer}</div>
        </details>
        <details class="rounded-ui bg-white border border-wood-200 p-4 shadow-ui group">
          <summary class="cursor-pointer font-semibold flex items-center justify-between">
            <span>${langData.faq.referral.question}</span>
            <span class="text-stone-400 group-open:rotate-180 transition">⌄</span>
          </summary>
          <div class="mt-3 text-stone-700">${langData.faq.referral.answer}</div>
        </details>
      `;

      const flagElement = document.getElementById('currentLangFlag');
      const nameElement = document.getElementById('currentLangName');
      
      if (flagElement && nameElement) {
        const flagCode = languageConfig[lang].flag;
        const name = languageConfig[lang].name;
        
        flagElement.className = `fi fi-${flagCode}`;
        nameElement.textContent = name;
      }
    }

    function renderLanguageSelector() {
      const container = document.getElementById('languageOptions');
      container.innerHTML = Object.entries(languageConfig).map(([code, lang]) => `
        <button class="w-full text-left px-4 py-2 hover:bg-wood-50 text-wood-900 transition-colors duration-150 ${code === currentLang ? 'bg-wood-100 text-wood-900 font-medium' : 'hover:text-wood-700'} flex items-center gap-3 rounded-md" 
                onclick="switchLanguage('${code}')">
          <span class="fi fi-${lang.flag} text-lg flex-shrink-0"></span>
          <span class="truncate">${lang.name}</span>
          ${code === currentLang ? '<span class="ml-auto text-wood-500 text-sm">✓</span>' : ''}
        </button>
      `).join('');
    }

    function switchLanguage(lang) {
      if (languageConfig[lang]) {
        currentLang = lang;
        localStorage.setItem('goosebox_lang', lang);
        updateLanguage(lang);
        renderLanguageSelector();
        
        const button = document.getElementById('currentLang');
        button.classList.add('scale-95');
        setTimeout(() => button.classList.remove('scale-95'), 150);
      }
    }

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        const dropdown = document.querySelector('.group');
        if (dropdown) {
          dropdown.classList.remove('group-hover:opacity-100', 'group-hover:visible', 'group-hover:scale-100');
        }
      }
    });

    document.addEventListener('DOMContentLoaded', initLanguage);
  </script>

  <script>
    // Lucky Draw timer: Sep 1, 2025 00:00:00 UTC to Sep 15, 2025 23:59:59 UTC
    const LUCKY_START = Date.UTC(2025, 8, 1, 0, 0, 0); // months 0-indexed
    const LUCKY_END = Date.UTC(2025, 8, 15, 23, 59, 59);

    let luckyTimerInterval;

    function initLuckyTimer() {
      const label = document.getElementById('luckyTimerLabel');
      const el = document.getElementById('luckyTimer');
      if (!el || !label) return;
      if (luckyTimerInterval) clearInterval(luckyTimerInterval);
      const update = () => {
        const now = Date.now();
        if (now < LUCKY_START) {
          label.textContent = 'Starts in';
          renderCountdown(el, LUCKY_START - now);
        } else if (now <= LUCKY_END) {
          label.textContent = 'Ends in';
          renderCountdown(el, LUCKY_END - now);
        } else {
          label.textContent = 'Ended';
          el.textContent = '00d 00h 00m 00s';
          clearInterval(luckyTimerInterval);
        }
      };
      update();
      luckyTimerInterval = setInterval(update, 1000);
    }

    function pad2(n){ return String(n).padStart(2,'0'); }
    function renderCountdown(targetEl, ms) {
      const totalSeconds = Math.max(0, Math.floor(ms / 1000));
      const days = Math.floor(totalSeconds / 86400);
      const hours = Math.floor((totalSeconds % 86400) / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;
      targetEl.textContent = `${pad2(days)}d ${pad2(hours)}h ${pad2(minutes)}m ${pad2(seconds)}s`;
    }
  </script>

</body>
</html>
